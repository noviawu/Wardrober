{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/xiaodanwu/Desktop/7th/CS app dev /Wardrober/screens/ItemCard.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { Modal, Portal, Button } from \"react-native-paper\";\nimport { firebaseRealtimeDB } from \"../firebase\";\nimport { generateID, uploadImage } from \"../utils/utils\";\nimport AsyncStorage, { useAsyncStorage } from \"@react-native-async-storage/async-storage\";\n\nvar ItemCard = function ItemCard() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      wardrobe = _useState2[0],\n      setWardrobe = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      modalOpen = _useState4[0],\n      setModalOpen = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      modalItem = _useState6[0],\n      setModalItem = _useState6[1];\n\n  useEffect(function () {\n    var getWardrobe = function getWardrobe() {\n      firebaseRealtimeDB.ref(\"items\").on(\"value\", function (querySnapshot) {\n        if (querySnapshot.exists()) {\n          var items = Object.values(querySnapshot.val());\n          setWardrobe(items);\n        } else {\n          console.log(\"No items found\");\n        }\n      });\n    };\n\n    getWardrobe();\n  }, []);\n\n  var getData = function getData() {\n    var keys, result, a;\n    return _regeneratorRuntime.async(function getData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getAllKeys());\n\n          case 3:\n            keys = _context.sent;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(AsyncStorage.multiGet(keys));\n\n          case 6:\n            result = _context.sent;\n            a = result.map(function (req) {\n              return JSON.parse(req[1]);\n            });\n            setWardrobe(a);\n            _context.next = 15;\n            break;\n\n          case 11:\n            _context.prev = 11;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(\"error in getData \");\n            console.dir(_context.t0);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 11]], Promise);\n  };\n\n  var renderItem = function renderItem(_ref) {\n    var item = _ref.item;\n    return React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        setModalOpen(true);\n        setModalItem(item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 5\n      }\n    }, React.createElement(View, {\n      style: styles.listItem,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 7\n      }\n    }, React.createElement(Text, {\n      style: styles.itemText,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }\n    }, item.name), React.createElement(Image, {\n      source: {\n        uri: item.image_url\n      },\n      style: styles.photo,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }\n    })));\n  };\n\n  var hideModal = function hideModal() {\n    return setModalOpen(false);\n  };\n\n  var handleDelete = function handleDelete(e) {\n    return _regeneratorRuntime.async(function handleDelete$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            console.log(\"deleted\");\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleFavorite = function handleFavorite(item) {\n    var id, url, newItem;\n    return _regeneratorRuntime.async(function handleFavorite$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            console.log(\"marked as favorite\");\n            id = generateID.getRandomID();\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(uploadImage.uploadImageAsync(item.image_url));\n\n          case 4:\n            url = _context3.sent;\n            newItem = {\n              id: id,\n              name: item.name,\n              category: item.category,\n              brand: item.brand,\n              image_url: url,\n              created_at: Date.now()\n            };\n            firebaseRealtimeDB.ref(\"favorites\").child(id).set(newItem, function (err) {\n              if (err) {\n                Alert.alert(\"Item could not be saved: \" + err);\n              } else {\n                Alert.alert(\"Item saved successfully\");\n              }\n            });\n            hideModal();\n\n          case 8:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var i = 0;\n  return React.createElement(View, {\n    style: styles.list,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }\n  }, React.createElement(FlatList, {\n    style: {\n      alignSelf: \"flex-start\"\n    },\n    data: wardrobe,\n    renderItem: renderItem,\n    keyExtractor: function keyExtractor() {\n      var key = i++;\n      return key.toString();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }\n  }), modalOpen ? React.createElement(Portal, {\n    style: {\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, React.createElement(Modal, {\n    visible: modalOpen,\n    onDismiss: hideModal,\n    contentContainerStyle: styles.modal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.itemName,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, modalItem.name), React.createElement(Image, {\n    source: {\n      uri: modalItem.image_url\n    },\n    style: styles.modalImage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    style: styles.itemDes,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }, \"Category: \", modalItem.category, \" \", \"\\n\", \" Brand: \", modalItem.brand), React.createElement(View, {\n    style: {\n      flexDirection: \"row\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    style: styles.button,\n    mode: \"contained\",\n    compact: true,\n    onPress: function onPress() {\n      handleFavorite(modalItem);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 15\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontFamily: \"Cochin\",\n      color: \"black\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, \"Favorite\")), React.createElement(Button, {\n    style: styles.button,\n    mode: \"contained\",\n    compact: true,\n    onPress: function onPress(e) {\n      handleDelete(e);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontFamily: \"Cochin\",\n      color: \"black\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, \"Delete\"))))) : null);\n};\n\nvar styles = StyleSheet.create({\n  list: {\n    flex: 5,\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  listItem: {\n    backgroundColor: \"#F8DE90\",\n    padding: 20,\n    marginVertical: 5,\n    width: 350,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  itemText: {\n    fontSize: 28,\n    fontFamily: \"Cochin\"\n  },\n  photo: {\n    width: 300,\n    height: 300\n  },\n  modal: {\n    backgroundColor: \"white\",\n    padding: 20,\n    margin: 20,\n    height: 450,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  itemName: {\n    fontSize: 28,\n    fontFamily: \"Cochin\",\n    color: \"black\"\n  },\n  itemDes: {\n    fontSize: 20,\n    fontFamily: \"Cochin\",\n    color: \"black\"\n  },\n  modalImage: {\n    width: 200,\n    height: 200\n  },\n  button: {\n    marginVertical: 10,\n    marginHorizontal: 20\n  }\n});\nexport default ItemCard;","map":{"version":3,"sources":["/Users/xiaodanwu/Desktop/7th/CS app dev /Wardrober/screens/ItemCard.js"],"names":["React","useState","useEffect","Modal","Portal","Button","firebaseRealtimeDB","generateID","uploadImage","AsyncStorage","useAsyncStorage","ItemCard","wardrobe","setWardrobe","modalOpen","setModalOpen","modalItem","setModalItem","getWardrobe","ref","on","querySnapshot","exists","items","Object","values","val","console","log","getData","getAllKeys","keys","multiGet","result","a","map","req","JSON","parse","dir","renderItem","item","styles","listItem","itemText","name","uri","image_url","photo","hideModal","handleDelete","e","handleFavorite","id","getRandomID","uploadImageAsync","url","newItem","category","brand","created_at","Date","now","child","set","err","Alert","alert","i","list","alignSelf","key","toString","justifyContent","alignItems","modal","itemName","modalImage","itemDes","flexDirection","button","fontFamily","color","StyleSheet","create","flex","backgroundColor","padding","marginVertical","width","fontSize","height","margin","marginHorizontal"],"mappings":"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","sourcesContent":["/**\n * This is the item card that will display the items' information\n * Author: Novia Wu\n * Date: 12/2/2021\n */\nimport React, { useState, useEffect } from \"react\";\nimport {\n  Text,\n  View,\n  FlatList,\n  StyleSheet,\n  Alert,\n  Image,\n  TouchableOpacity,\n} from \"react-native\";\nimport { Modal, Portal, Button } from \"react-native-paper\";\nimport { firebaseRealtimeDB } from \"../firebase\";\nimport { generateID, uploadImage } from \"../utils/utils\";\nimport AsyncStorage, {\n  useAsyncStorage,\n} from \"@react-native-async-storage/async-storage\";\n\nconst ItemCard = () => {\n  const [wardrobe, setWardrobe] = useState([]);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalItem, setModalItem] = useState();\n\n  useEffect(() => {\n    const getWardrobe = () => {\n      firebaseRealtimeDB.ref(\"items\").on(\"value\", (querySnapshot) => {\n        if (querySnapshot.exists()) {\n          const items = Object.values(querySnapshot.val());\n          setWardrobe(items);\n        } else {\n          console.log(\"No items found\");\n        }\n      });\n    };\n    getWardrobe();\n  }, []);\n\n  const getData = async () => {\n    try {\n      const keys = await AsyncStorage.getAllKeys();\n      const result = await AsyncStorage.multiGet(keys);\n      const a = result.map((req) => JSON.parse(req[1]));\n      setWardrobe(a);\n    } catch (e) {\n      console.log(\"error in getData \");\n      console.dir(e);\n    }\n  };\n\n  const renderItem = ({ item }) => (\n    <TouchableOpacity\n      onPress={() => {\n        setModalOpen(true);\n        setModalItem(item);\n      }}\n    >\n      <View style={styles.listItem}>\n        <Text style={styles.itemText}>{item.name}</Text>\n        <Image\n          source={{\n            uri: item.image_url,\n          }}\n          style={styles.photo}\n        ></Image>\n      </View>\n    </TouchableOpacity>\n  );\n\n  const hideModal = () => setModalOpen(false);\n\n  const handleDelete = async (e) => {\n    console.log(\"deleted\");\n  };\n\n  const handleFavorite = async (item) => {\n    console.log(\"marked as favorite\");\n    const id = generateID.getRandomID();\n    const url = await uploadImage.uploadImageAsync(item.image_url);\n    // upload the same product to Firebase Realtime Database's favorites column\n    var newItem = {\n      id: id,\n      name: item.name,\n      category: item.category,\n      brand: item.brand,\n      image_url: url,\n      created_at: Date.now(),\n    };\n    firebaseRealtimeDB\n      .ref(\"favorites\")\n      .child(id)\n      .set(newItem, (err) => {\n        if (err) {\n          Alert.alert(\"Item could not be saved: \" + err);\n        } else {\n          Alert.alert(\"Item saved successfully\");\n        }\n      });\n    hideModal();\n  };\n\n  let i = 0;\n  return (\n    <View style={styles.list}>\n      <FlatList\n        style={{ alignSelf: \"flex-start\" }}\n        data={wardrobe}\n        renderItem={renderItem}\n        keyExtractor={() => {\n          const key = i++;\n          return key.toString();\n        }}\n      />\n      {modalOpen ? (\n        <Portal style={{ justifyContent: \"center\", alignItems: \"center\" }}>\n          <Modal\n            visible={modalOpen}\n            onDismiss={hideModal}\n            contentContainerStyle={styles.modal}\n          >\n            <Text style={styles.itemName}>{modalItem.name}</Text>\n            <Image\n              source={{\n                uri: modalItem.image_url,\n              }}\n              style={styles.modalImage}\n            ></Image>\n            <Text style={styles.itemDes}>\n              Category: {modalItem.category} {\"\\n\"} Brand: {modalItem.brand}\n            </Text>\n            <View style={{ flexDirection: \"row\" }}>\n              <Button\n                style={styles.button}\n                mode=\"contained\"\n                compact={true}\n                onPress={() => {\n                  handleFavorite(modalItem);\n                }}\n              >\n                <Text style={{ fontFamily: \"Cochin\", color: \"black\" }}>\n                  Favorite\n                </Text>\n              </Button>\n              <Button\n                style={styles.button}\n                mode=\"contained\"\n                compact={true}\n                onPress={(e) => {\n                  handleDelete(e);\n                }}\n              >\n                <Text style={{ fontFamily: \"Cochin\", color: \"black\" }}>\n                  Delete\n                </Text>\n              </Button>\n            </View>\n          </Modal>\n        </Portal>\n      ) : null}\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  list: {\n    flex: 5,\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  listItem: {\n    backgroundColor: \"#F8DE90\",\n    padding: 20,\n    marginVertical: 5,\n    width: 350,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  itemText: {\n    fontSize: 28,\n    fontFamily: \"Cochin\",\n  },\n  photo: {\n    width: 300,\n    height: 300,\n  },\n  modal: {\n    backgroundColor: \"white\",\n    padding: 20,\n    margin: 20,\n    height: 450,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  itemName: {\n    fontSize: 28,\n    fontFamily: \"Cochin\",\n    color: \"black\",\n  },\n  itemDes: {\n    fontSize: 20,\n    fontFamily: \"Cochin\",\n    color: \"black\",\n  },\n  modalImage: {\n    width: 200,\n    height: 200,\n  },\n  button: {\n    marginVertical: 10,\n    marginHorizontal: 20,\n  },\n});\n\nexport default ItemCard;\n"]},"metadata":{},"sourceType":"module"}